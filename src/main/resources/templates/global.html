<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:fragment="head(title)">
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link th:href="@{/css/bootstrap.min.css}" href="/mycloud/static/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"/>
    <link th:href="@{/css/bootstrap-theme.min.css}" href="/mycloud/static/css/bootstrap-theme.min.css" rel="stylesheet"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"/>
    <link th:href="@{/image/favicon.ico}" href="/mycloud/static/image/favicon.ico" rel="shortcut icon" type="image/ico"/>
    <title th:text="${title}">global</title>
</head>
<body>
<div class="container">

    <div class="row" th:fragment="navigation">
        <nav class="navbar navbar-default" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a href="/"><img th:src="@{/image/favicon.ico}" src="/mycloud/static/image/favicon.ico" class="navbar-brand"/></a>
                </div>
                <ul class="nav navbar-nav">
                    <li>
                        <a th:href="@{/admin/1}" class="navbar-brand">mycloud</a>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><p class="navbar-text">我的文件服务器 mycloud</p></li>
                </ul>
            </div>
        </nav>
        <br/>
    </div>


    <div class="row" th:fragment="uploadFileForm(token)">
        <div class="page-header">
            <h3>上传文件</h3>
        </div>
        <form th:action="@{/api/uploadFile}" method="post" id="uploadFileForm" class="form-horizontal" role="form" enctype="multipart/form-data" onsubmit="return false;">
            <div class="form-group">
                <label class="col-sm-2 control-label">上传文件</label>
                <div class="col-sm-10">
                    <input type="file" name="file" id="uploadFileFormFile" class="form-control" required="required"/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">上传日期</label>
                <div class="col-sm-10">
                    <input th:value="${#dates.format(new java.util.Date(),'yyyy-MM-dd')}" type="date" name="date" id="uploadFileFormDate" class="form-control"/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">是否备份</label>
                <div class="col-sm-10">
                    <label class="radio-inline">
                        <input type="radio" name="status" value="1" checked="checked"/> 备份
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="status"  value="0"/> 不备份
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">描述</label>
                <div class="col-sm-10">
                    <textarea name="description" id="uploadFileFormDescription" maxlength="255" class="form-control"></textarea>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10"></div>
                <div class="col-sm-2">
                    <button type="submit" class="btn btn-default" onclick="uploadFile()">上传</button>
                </div>
            </div>
        </form>
    </div>


    <div class="row" th:fragment="inquire">
        <div class="page-header">
            <h3>查询</h3>
        </div>
        <form th:action="@{/admin}" method="get" class="form-inline" role="form">
            <div class="form-group">
                <label>上传日期</label>
                <input th:value="${#dates.format(new java.util.Date(),'yyyy-MM-dd')}" name="date" type="date" class="form-control" required="required"/>
            </div>
            <button type="submit" class="btn btn-default">查询</button>
        </form>
        <br/>
        <form th:action="@{/admin}" method="get" class="form-inline" role="form">
            <div class="form-group">
                <label>匹配文件名</label>
                <input name="filename" type="text" class="form-control" required="required"/>
            </div>
            <button type="submit" class="btn btn-default">查询</button>
        </form>
        <br/>
        <form th:action="@{/admin}" method="get" class="form-inline" role="form">
            <div class="form-group">
                <label>匹配描述</label>
                <input name="description" type="text" class="form-control" required="required"/>
            </div>
            <button type="submit" class="btn btn-default">查询</button>
        </form>
    </div>


    <div class="row" th:fragment="listFile(files)">
        <table class="table table-hover">
            <caption>文件列表</caption>
            <thead>
            <tr>
                <th>缩略图</th>
                <th>信息</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="file : ${files}">
                <td><a th:href="${file.url}" target="_blank"><img th:src="${file.url}" th:alt="${file.filename}" class="img-responsive" style="max-height: 100%;max-width: 100%" src="http://img.my.csdn.net/uploads/201606/15/1465969447_3596.png"/></a></td>
                <td>
                    <table class="table table-hover" style="background-color: rgba(0, 0, 0, 0);">
                        <tbody>
                        <tr>
                            <td>上传日期</td>
                            <td><code th:text="${#dates.format(file.date,'yyyy-MM-dd')}">2017-12-12</code></td>
                        </tr>
                        <tr>
                            <td>文件名</td>
                            <td><code th:text="${file.filename}">xxx.jpg</code></td>
                        </tr>
                        <tr>
                            <td>文件大小</td>
                            <td><code th:text="${file.fileSize}">10KB</code></td>
                        </tr>
                        <tr>
                            <td>描述</td>
                            <td><code th:text="${file.description}">不可描述</code></td>
                        </tr>
                        <tr>
                            <td>链接</td>
                            <td><code th:text="${file.url}">/drive/xxx.jpg</code></td>
                        </tr>
                        <tr>
                            <td>操作</td>
                            <td>
                                <button th:onclick="'javascript:backup(\''+${file.filename}+'\',\''+${#dates.format(file.date,'yyyy-MM-dd')}+'\',\''+@{/admin/backup}+'\');'" type="button" class="btn btn-info">备份</button>
                                <button th:onclick="'javascript:restore(\''+${file.filename}+'\',\''+${#dates.format(file.date,'yyyy-MM-dd')}+'\',\''+@{/admin/restore}+'\');'" type="button" class="btn btn-info">恢复</button>
                                <button th:onclick="'javascript:remove(\''+${file.filename}+'\',\''+${#dates.format(file.date,'yyyy-MM-dd')}+'\',\''+@{/admin/remove}+'\');'" type="button" class="btn btn-danger">删除</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            </tbody>
        </table>
    </div>


    <div class="row" th:fragment="pages(pages)" style="text-align: center">
        <ul class="pagination">
            <li th:each="page : ${pages}"><a th:href="${page}" th:text="${page}">1</a></li>
        </ul>
    </div>


    <div class="row" th:fragment="loginForm(info)">
        <div class="page-header">
            <h1>mycloud后台管理登录</h1>
        </div>
        <form th:action="@{/}" method="post" class="form-horizontal" role="form">
            <div class="form-group">
                <label class="col-sm-2 control-label">口令</label>
                <div class="col-sm-10">
                    <input name="token" type="password" class="form-control" placeholder="口令" required="required"/>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10">
                    <button type="submit" class="btn btn-default">登录</button>
                    <span th:text="${info}" class="label label-danger">口令错误</span>
                </div>
            </div>
        </form>
    </div>


    <div class="row" th:fragment="status(failBackupCount,successBackupCount,waitBackupCount,failRestoreCount,successRestoreCount,waitRestoreCount)">
        <div class="page-header">
            <h3>全局概况</h3>
        </div>
        <table class="table table-hover">
            <thead>
            <tr>
                <th>备份失败</th>
                <th>备份成功</th>
                <th>备份队列</th>
                <th>全部备份</th>
                <th>恢复失败</th>
                <th>恢复成功</th>
                <th>恢复队列</th>
                <th>全部恢复</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td><code th:text="${failBackupCount}">备份失败</code></td>
                <td><code th:text="${successBackupCount}">备份成功</code></td>
                <td><code th:text="${waitBackupCount}">备份队列</code></td>
                <td><button th:onclick="'javascript:backupAll(\''+@{/admin/backupAll}+'\');'" type="button" class="btn btn-info">全部备份</button></td>
                <td><code th:text="${failRestoreCount}">恢复失败</code></td>
                <td><code th:text="${successRestoreCount}">恢复成功</code></td>
                <td><code th:text="${waitRestoreCount}">恢复队列</code></td>
                <td><button th:onclick="'javascript:restoreAll(\''+@{/admin/restoreAll}+'\');'" type="button" class="btn btn-info">全部恢复</button></td>
            </tr>
            </tbody>
        </table>
    </div>


    <div class="row" th:fragment="tail">
        <div style="text-align: center;padding: 2%;margin-top: 2%;background-color: #2aabd2;">
            <p>我的文件服务器 mycloud</p>
            <p>2018-1-18版本</p>
        </div>
    </div>

</div>

<div th:fragment="publicJs">
    <script th:src="@{/js/jquery-3.2.1.min.js}" src="/mycloud/static/js/jquery-3.2.1.min.js" type="text/javascript"></script>
    <script th:src="@{/js/bootstrap.min.js}" src="/mycloud/static/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</div>
<div th:fragment="privateJs">
    <script th:src="@{/js/private.js}" src="/mycloud/static/js/private.js"></script>
    <input th:value="${token}" id="token" type="hidden"/>
</div>
</body>
</html>